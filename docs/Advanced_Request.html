---

title: 进阶的爬虫

keywords: fastai
sidebar: home_sidebar

summary: "1. 更复杂的请求"
description: "1. 更复杂的请求"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_Advanced_Request.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">urls</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">https://www.zhihu.com/topic/19554834/hot</span>
<span class="s1">https://book.douban.com/tag/</span><span class="si">%E</span><span class="s1">5%A4</span><span class="si">%96%</span><span class="s1">E5%9B%BD</span><span class="si">%E</span><span class="s1">6</span><span class="si">%96%</span><span class="s1">87</span><span class="si">%E</span><span class="s1">5%AD%A6</span>
<span class="s1">https://search.bilibili.com/all?keyword=</span><span class="si">%E</span><span class="s1">5%A4%A7</span><span class="si">%E</span><span class="s1">7</span><span class="si">%88%</span><span class="s1">B7&amp;from_source=banner_search</span>
<span class="s1">https://github.com/trending</span>
<span class="s1">https://search.jd.com/Search?keyword=</span><span class="si">%E</span><span class="s1">7</span><span class="si">%94%</span><span class="s1">B5</span><span class="si">%E</span><span class="s1">8</span><span class="si">%84%</span><span class="s1">91&amp;enc=utf-8&amp;wq=</span><span class="si">%E</span><span class="s1">7</span><span class="si">%94%</span><span class="s1">B5</span><span class="si">%E</span><span class="s1">8</span><span class="si">%84%</span><span class="s1">91&amp;pvid=254ed16260384a18a34c1c452b6db180</span>
<span class="s1">https://bj.lianjia.com/ershoufang/</span>
<span class="s1">http://www.rrys2019.com/html/top/week_fav_list.html</span>
<span class="s1">https://weixin.sogou.com/weixin?type=2&amp;ie=utf8&amp;s_from=hotnews&amp;query=</span><span class="si">%E</span><span class="s1">9%9B%B7</span><span class="si">%E</span><span class="s1">7%A5</span><span class="si">%9E%E</span><span class="s1">5%B1%B1</span><span class="si">%E</span><span class="s1">6%9C%BA</span><span class="si">%E</span><span class="s1">5</span><span class="si">%99%</span><span class="s1">A8</span><span class="si">%E</span><span class="s1">4%BA%BA</span><span class="si">%E</span><span class="s1">4%B8%8A</span><span class="si">%E</span><span class="s1">5%B2%97</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">url_list</span> <span class="o">=</span> <span class="n">urls</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">soup_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">url_list</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;start:&#39;</span><span class="p">,</span><span class="n">url</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;user-agent&#39;</span><span class="p">:</span><span class="s1">&#39;Mozilla/5.0&#39;</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">,</span><span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
        <span class="n">soup_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">soup</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start: https://www.zhihu.com/topic/19554834/hot
start: https://book.douban.com/tag/%E5%A4%96%E5%9B%BD%E6%96%87%E5%AD%A6
start: https://search.bilibili.com/all?keyword=%E5%A4%A7%E7%88%B7&amp;from_source=banner_search
start: https://github.com/trending
start: https://search.jd.com/Search?keyword=%E7%94%B5%E8%84%91&amp;enc=utf-8&amp;wq=%E7%94%B5%E8%84%91&amp;pvid=254ed16260384a18a34c1c452b6db180
start: https://bj.lianjia.com/ershoufang/
start: http://www.rrys2019.com/html/top/week_fav_list.html
start: https://weixin.sogou.com/weixin?type=2&amp;ie=utf8&amp;s_from=hotnews&amp;query=%E9%9B%B7%E7%A5%9E%E5%B1%B1%E6%9C%BA%E5%99%A8%E4%BA%BA%E4%B8%8A%E5%B2%97
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">soup_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">url_list</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#26356;&#22797;&#26434;&#30340;&#35831;&#27714;">&#26356;&#22797;&#26434;&#30340;&#35831;&#27714;<a class="anchor-link" href="#&#26356;&#22797;&#26434;&#30340;&#35831;&#27714;"> </a></h2><blockquote><p>以豆瓣网为例</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>一开始没有header的请求会被拒绝，因为服务器会把这次的请求当成是机器人，status_code是418</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>加了header之后，服务器就把它当成了Mozilla浏览器，就有response的数据了</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>想要发布一个动态就需要登录状态，而cookie就是登录状态的载体，cookie就是用帐号密码登录后获取的凭证</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="format_cookie_str" class="doc_header"><code>format_cookie_str</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/utils.py#L13" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>format_cookie_str</code>(<strong><code>cookie_str</code></strong>)</p>
</blockquote>
<p>把chrome拷贝过来的cookie字符转化成dict</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cookie_str</span> <span class="o">=</span> <span class="s1">&#39;bid=1i8YWHFPDwI; gr_user_id=5b798ccf-0dc3-41f7-9358-ab221ae5c248; __utmc=30149280; __utmz=30149280.1582040380.5.5.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); ll=&quot;118124&quot;; _pk_ref.100001.8cb4=%5B</span><span class="si">%22%</span><span class="s1">22%2C</span><span class="si">%22%</span><span class="s1">22%2C1582185091%2C%22https%3A</span><span class="si">%2F%2F</span><span class="s1">www.google.com</span><span class="si">%2F%22%</span><span class="s1">5D; _pk_ses.100001.8cb4=*; __utma=30149280.682236232.1580713449.1582121697.1582185095.7; ap_v=0,6.0; viewed=&quot;19672873_30243169_4233221&quot;; gr_cs1_6bb1b2b8-0a3e-4e02-9e3c-4f359d514576=user_id%3A0; __utmt_douban=1; dbcl2=&quot;140014301:Td6zJ+yn5sA&quot;; ck=zV8Z; gr_session_id_22c937bbd8ebd703f2d8e9445f7dfd03=7a596b44-fe53-45f0-90fa-2c24b2faa365; gr_cs1_7a596b44-fe53-45f0-90fa-2c24b2faa365=user_id%3A1; gr_session_id_22c937bbd8ebd703f2d8e9445f7dfd03_7a596b44-fe53-45f0-90fa-2c24b2faa365=true; push_noty_num=0; push_doumail_num=0; __utmv=30149280.14001; __utmt=1; ps=y; _pk_id.100001.8cb4=7bc8021c269d7e50.1580713448.6.1582185748.1582121848.; __utmb=30149280.18.10.1582185095&#39;</span>
<span class="n">cookies</span> <span class="o">=</span> <span class="n">format_cookie_str</span><span class="p">(</span><span class="n">cookie_str</span><span class="p">)</span>
<span class="n">cookies</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;bid&#39;: &#39;1i8YWHFPDwI&#39;,
 &#39;gr_user_id&#39;: &#39;5b798ccf-0dc3-41f7-9358-ab221ae5c248&#39;,
 &#39;__utmc&#39;: &#39;30149280&#39;,
 &#39;__utmz&#39;: &#39;30149280.1582040380.5.5.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided)&#39;,
 &#39;ll&#39;: &#39;&#34;118124&#34;&#39;,
 &#39;_pk_ref.100001.8cb4&#39;: &#39;%5B%22%22%2C%22%22%2C1582185091%2C%22https%3A%2F%2Fwww.google.com%2F%22%5D&#39;,
 &#39;_pk_ses.100001.8cb4&#39;: &#39;*&#39;,
 &#39;__utma&#39;: &#39;30149280.682236232.1580713449.1582121697.1582185095.7&#39;,
 &#39;ap_v&#39;: &#39;0,6.0&#39;,
 &#39;viewed&#39;: &#39;&#34;19672873_30243169_4233221&#34;&#39;,
 &#39;gr_cs1_6bb1b2b8-0a3e-4e02-9e3c-4f359d514576&#39;: &#39;user_id%3A0&#39;,
 &#39;__utmt_douban&#39;: &#39;1&#39;,
 &#39;dbcl2&#39;: &#39;&#34;140014301:Td6zJ+yn5sA&#34;&#39;,
 &#39;ck&#39;: &#39;zV8Z&#39;,
 &#39;gr_session_id_22c937bbd8ebd703f2d8e9445f7dfd03&#39;: &#39;7a596b44-fe53-45f0-90fa-2c24b2faa365&#39;,
 &#39;gr_cs1_7a596b44-fe53-45f0-90fa-2c24b2faa365&#39;: &#39;user_id%3A1&#39;,
 &#39;gr_session_id_22c937bbd8ebd703f2d8e9445f7dfd03_7a596b44-fe53-45f0-90fa-2c24b2faa365&#39;: &#39;true&#39;,
 &#39;push_noty_num&#39;: &#39;0&#39;,
 &#39;push_doumail_num&#39;: &#39;0&#39;,
 &#39;__utmv&#39;: &#39;30149280.14001&#39;,
 &#39;__utmt&#39;: &#39;1&#39;,
 &#39;ps&#39;: &#39;y&#39;,
 &#39;_pk_id.100001.8cb4&#39;: &#39;7bc8021c269d7e50.1580713448.6.1582185748.1582121848.&#39;,
 &#39;__utmb&#39;: &#39;30149280.18.10.1582185095&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>顺便看看tag的其他属性，上下左右查到其他的tag</p>
<ul>
<li>item.parent</li>
<li><p>item.parents</p>
</li>
<li><p>item.contents</p>
</li>
<li><p>item.children</p>
</li>
<li><p>item.next_sibling</p>
</li>
<li>item.previous_sibling</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="JSON-&#23384;&#20648;">JSON &#23384;&#20648;<a class="anchor-link" href="#JSON-&#23384;&#20648;"> </a></h2><blockquote><p>这个格式本质上就是个dict，在MongoDB和Redis中也是这样存储，所以这里就开始学习下</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>比如这次要把谁在什么时间，说了什么话记下来</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#20445;&#23384;&#21644;&#35835;&#21462;json">&#20445;&#23384;&#21644;&#35835;&#21462;json<a class="anchor-link" href="#&#20445;&#23384;&#21644;&#35835;&#21462;json"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#33258;&#21160;&#35782;&#21035;&#21015;&#34920;">&#33258;&#21160;&#35782;&#21035;&#21015;&#34920;<a class="anchor-link" href="#&#33258;&#21160;&#35782;&#21035;&#21015;&#34920;"> </a></h2><blockquote><p>思路就是看谁有最多的相同类的children（目前只支持静态页面,文字列表）</p>
</blockquote>
<p>常见问题：容易识别成目录，特征为多层级列表，而正文内容则不会再嵌套列表</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_children" class="doc_header"><code>get_children</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/utils.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_children</code>(<strong><code>soup</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_class" class="doc_header"><code>get_class</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/utils.py#L24" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_class</code>(<strong><code>soup</code></strong>)</p>
</blockquote>
<p>获取单个tag的class，没有则显示no_class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_all_class" class="doc_header"><code>get_all_class</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/utils.py#L31" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_all_class</code>(<strong><code>soup</code></strong>)</p>
</blockquote>
<p>收集每个tag的class，没有则显示no_class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_class_count" class="doc_header"><code>get_class_count</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/utils.py#L38" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_class_count</code>(<strong><code>soup</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_content_list" class="doc_header"><code>is_content_list</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/utils.py#L40" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_content_list</code>(<strong><code>soup</code></strong>)</p>
</blockquote>
<p>判断是否为内容列表，条件为：子集是重复的相同的tag，重复次数大于5</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="find_main_list" class="doc_header"><code>find_main_list</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/utils.py#L58" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>find_main_list</code>(<strong><code>soup</code></strong>)</p>
</blockquote>
<p>特征：文字内容多；一条数据的样式&amp;嵌套丰富；区别于目录，都是很短的词</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">main_content_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">url</span><span class="p">,</span><span class="n">soup</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">url_list</span><span class="p">,</span><span class="n">soup_list</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup_test</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">body</span>
    <span class="n">main_content_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">find_main_list</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>https://www.zhihu.com/topic/19554834/hot
终选：
 div [&#39;no_class&#39;] div [&#39;List-item&#39;, &#39;TopicFeedItem&#39;] 

https://book.douban.com/tag/%E5%A4%96%E5%9B%BD%E6%96%87%E5%AD%A6
终选：
 ul [&#39;subject-list&#39;] li [&#39;subject-item&#39;] 

https://search.bilibili.com/all?keyword=%E5%A4%A7%E7%88%B7&amp;from_source=banner_search
终选：
 ul [&#39;video-list&#39;, &#39;clearfix&#39;] li [&#39;video-item&#39;, &#39;matrix&#39;] 

https://github.com/trending
终选：
 div [&#39;no_class&#39;] article [&#39;Box-row&#39;] 

https://search.jd.com/Search?keyword=%E7%94%B5%E8%84%91&amp;enc=utf-8&amp;wq=%E7%94%B5%E8%84%91&amp;pvid=254ed16260384a18a34c1c452b6db180
终选：
 ul [&#39;gl-warp&#39;, &#39;clearfix&#39;] li [&#39;gl-item&#39;] 

https://bj.lianjia.com/ershoufang/
终选：
 ul [&#39;sellListContent&#39;] li [&#39;clear&#39;, &#39;LOGVIEWDATA&#39;, &#39;LOGCLICKDATA&#39;] 

http://www.rrys2019.com/html/top/week_fav_list.html
终选：
 ul [&#39;no_class&#39;] li [&#39;clearfix&#39;] 

https://weixin.sogou.com/weixin?type=2&amp;ie=utf8&amp;s_from=hotnews&amp;query=%E9%9B%B7%E7%A5%9E%E5%B1%B1%E6%9C%BA%E5%99%A8%E4%BA%BA%E4%B8%8A%E5%B2%97
终选：
 ul [&#39;news-list&#39;] li [&#39;no_class&#39;] 

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#33258;&#21160;&#35782;&#21035;&#19979;&#19968;&#39029;">&#33258;&#21160;&#35782;&#21035;&#19979;&#19968;&#39029;<a class="anchor-link" href="#&#33258;&#21160;&#35782;&#21035;&#19979;&#19968;&#39029;"> </a></h2><blockquote><p>根据文字识别，暂不支持滚动加载，大部分未识别出来，因为下一页大多用js实现</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_next_page" class="doc_header"><code>is_next_page</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/utils.py#L80" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_next_page</code>(<strong><code>tag</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_next_page_url" class="doc_header"><code>get_next_page_url</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/utils.py#L82" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_next_page_url</code>(<strong><code>soup</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">url</span><span class="p">,</span><span class="n">soup</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">url_list</span><span class="p">,</span><span class="n">soup_list</span><span class="p">):</span>
<span class="c1">#     if &#39;douban&#39; in url:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">url</span><span class="p">)</span>
        <span class="n">soup_test</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">body</span>
<span class="c1">#         print(soup_test)</span>
        <span class="n">get_next_page_url</span><span class="p">(</span><span class="n">soup_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
 https://www.zhihu.com/topic/19554834/hot
未识别出下一页

 https://book.douban.com/tag/%E5%A4%96%E5%9B%BD%E6%96%87%E5%AD%A6
下一页： /tag/外国文学?start=20&amp;type=T

 https://search.bilibili.com/all?keyword=%E5%A4%A7%E7%88%B7&amp;from_source=banner_search
未识别出下一页

 https://github.com/trending
未识别出下一页

 https://search.jd.com/Search?keyword=%E7%94%B5%E8%84%91&amp;enc=utf-8&amp;wq=%E7%94%B5%E8%84%91&amp;pvid=254ed16260384a18a34c1c452b6db180
未识别出下一页

 https://bj.lianjia.com/ershoufang/
未识别出下一页

 http://www.rrys2019.com/html/top/week_fav_list.html
未识别出下一页

 https://weixin.sogou.com/weixin?type=2&amp;ie=utf8&amp;s_from=hotnews&amp;query=%E9%9B%B7%E7%A5%9E%E5%B1%B1%E6%9C%BA%E5%99%A8%E4%BA%BA%E4%B8%8A%E5%B2%97
下一页： ?query=%E9%9B%B7%E7%A5%9E%E5%B1%B1%E6%9C%BA%E5%99%A8%E4%BA%BA%E4%B8%8A%E5%B2%97&amp;s_from=hotnews&amp;type=2&amp;page=2&amp;ie=utf8
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#33258;&#21160;&#35782;&#21035;&#21015;&#34920;&#20869;&#23481;">&#33258;&#21160;&#35782;&#21035;&#21015;&#34920;&#20869;&#23481;<a class="anchor-link" href="#&#33258;&#21160;&#35782;&#21035;&#21015;&#34920;&#20869;&#23481;"> </a></h2><blockquote><p>思路就是样式一样的，是一类的内容</p>
</blockquote>
<p>目前支持的几种内容类型：</p>
<ol>
<li>img link</li>
</ol>
<ul>
<li>a link</li>
<li>text</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_child_navigablestring" class="doc_header"><code>get_child_navigablestring</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/utils.py#L92" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_child_navigablestring</code>(<strong><code>soup</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_data_name" class="doc_header"><code>get_data_name</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/utils.py#L100" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_data_name</code>(<strong><code>soup</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_data" class="doc_header"><code>get_data</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/utils.py#L104" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_data</code>(<strong><code>soup</code></strong>)</p>
</blockquote>
<p>列出每一项，如果为a或img标签，就获取链接和内容；如果子集含navstr，就显示文字</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">url</span><span class="p">,</span><span class="n">soup</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">url_list</span><span class="p">,</span><span class="n">main_content_list</span><span class="p">):</span>
<span class="c1">#     if &#39;douban&#39; in url:</span>
<span class="c1">#         print(&#39;\n&#39;,url)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">get_children</span><span class="p">(</span><span class="n">soup</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1">#         print(data)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}
</div>
 

