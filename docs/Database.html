---

title: 数据库

keywords: fastai
sidebar: home_sidebar

summary: "Redis，MongoDB如何选择"
description: "Redis，MongoDB如何选择"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 12_Database.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Redis-&#23448;&#32593;">Redis <a href="https://redis.io/">&#23448;&#32593;</a><a class="anchor-link" href="#Redis-&#23448;&#32593;"> </a></h2><blockquote><p><a href="http: //try.redis.io/">线上体验redis</a>
Redis优势（可以用作数据库、缓存和消息中间件）：</p>
<ul>
<li>速度快：性能极高 – Redis能读的速度是110000次/s,写的速度是81000次/s </li>
<li>持久化：可以通过RDB和AOF两种方式，定期/实时将数据持久化到磁盘上</li>
<li>支持多种数据结构：支持五种基本的数据结构，分别是String（字符串），Hash（哈希），List（列表），Set（集合），Zset（即Sorted Set有序集合）</li>
<li>集群&amp;主从复制</li>
</ul>
</blockquote>
<p>安装步骤：</p>
<ul>
<li>mac上安装redis： <code>brew install redis</code></li>
<li>安装python中调用redis的插件：<code>pip install redis</code> <a href="https://redis-py.readthedocs.io/en/latest/">redis-py文档</a>   |  <a href="https://redislabs.com/lp/python-redis/">安装教程</a></li>
<li>命令行中启动redis服务：<code>redis-server</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">decode_responses</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="c1"># host是redis主机，需要redis服务端和客户端都启动 redis默认端口是6379</span>
<span class="n">r</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;neo&#39;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;neo&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#36830;&#25509;&#27744;(connection-pool)-&#21407;&#29702;">&#36830;&#25509;&#27744;(connection pool) <a href="https://www.u3v3.com/ar/1346">&#21407;&#29702;</a><a class="anchor-link" href="#&#36830;&#25509;&#27744;(connection-pool)-&#21407;&#29702;"> </a></h3><ul>
<li>通常情况：连接-释放，完成一次数据读写</li>
<li>高并发：频繁的连接创建和释放对性能会有较高的影响</li>
<li>连接池：创建的连接不立即释放，而更多的请求发生时，会额外创建新的连接，这样多个就不会因为连接和释放影响数据读写性能</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pool</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">ConnectionPool</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">decode_responses</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rdb</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">connection_pool</span><span class="o">=</span><span class="n">pool</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rdb</span><span class="o">.</span><span class="n">hmset</span><span class="p">(</span><span class="s2">&quot;001&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;neo&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="s2">&quot;30&quot;</span><span class="p">})</span>
<span class="n">rdb</span><span class="o">.</span><span class="n">hmset</span><span class="p">(</span><span class="s2">&quot;001&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;sex&quot;</span><span class="p">:</span> <span class="s2">&quot;male&quot;</span><span class="p">})</span>
<span class="n">rdb</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s1">&#39;001&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;name&#39;: &#39;neo&#39;, &#39;age&#39;: &#39;30&#39;, &#39;sex&#39;: &#39;male&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rdb</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;001&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rdb</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s1">&#39;001&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#25968;&#25454;&#23384;&#20648;">&#25968;&#25454;&#23384;&#20648;<a class="anchor-link" href="#&#25968;&#25454;&#23384;&#20648;"> </a></h3><p>redis会定期将内存中的数据同步到磁盘中，默认为启动目录下的<code>dump.rdb</code>;
如果要修改存储方式和文件，需要修改<code>redis.conf</code>文件</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#29228;&#19979;&#21416;&#25151;&#33756;&#35889;">&#29228;&#19979;&#21416;&#25151;&#33756;&#35889;<a class="anchor-link" href="#&#29228;&#19979;&#21416;&#25151;&#33756;&#35889;"> </a></h2><blockquote><p>因为平时做菜，想找到哪些材料，会明显提升菜的受欢迎程度，所以打算先爬所有热门菜谱的id，然后再爬详情页的配料表和互动数据</p>
</blockquote>
<h3 id="&#20808;&#20174;&#27599;&#26376;50&#26368;&#20339;&#33756;&#35889;&#24320;&#22987;">&#20808;&#20174;&#27599;&#26376;50&#26368;&#20339;&#33756;&#35889;&#24320;&#22987;<a class="anchor-link" href="#&#20808;&#20174;&#27599;&#26376;50&#26368;&#20339;&#33756;&#35889;&#24320;&#22987;"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">px</span> <span class="o">=</span> <span class="n">Proxy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>加载成功 364
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#33719;&#21462;&#24453;&#35775;&#38382;&#30340;url&#21015;&#34920;">&#33719;&#21462;&#24453;&#35775;&#38382;&#30340;url&#21015;&#34920;<a class="anchor-link" href="#&#33719;&#21462;&#24453;&#35775;&#38382;&#30340;url&#21015;&#34920;"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_monthhonor_urls</span><span class="p">():</span>
    <span class="n">url_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span><span class="mi">2021</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">month</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">month</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;0</span><span class="si">{month}</span><span class="s1">&#39;</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;http://www.xiachufang.com/explore/monthhonor/</span><span class="si">{year}{month}</span><span class="s1">/&#39;</span>
            <span class="n">url_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="n">url_page_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">url_list</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]:</span>
            <span class="n">url_page_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{url}</span><span class="s1">?page=</span><span class="si">{page}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;url_counts:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">url_page_list</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">url_page_list</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_monthhonor_urls</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>url_counts: 216
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;http://www.xiachufang.com/explore/monthhonor/201103/?page=1&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_crawl_recipe_ids</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">px</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">,</span><span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
    <span class="n">a_list</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="k">lambda</span> <span class="n">tag</span> <span class="p">:</span> <span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span> <span class="ow">and</span> <span class="n">tag</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;p&#39;</span> <span class="ow">and</span> <span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">tag</span><span class="o">.</span><span class="n">parent</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">])</span>
    <span class="n">id_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">a_list</span><span class="p">]</span>
    <span class="n">id_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">id_list</span><span class="p">,[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">id_list</span><span class="p">))]))</span>
    
    <span class="n">rdb</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">decode_responses</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="c1"># host是redis主机，需要redis服务端和客户端都启动 redis默认端口是6379</span>
    <span class="n">rdb</span><span class="o">.</span><span class="n">hmset</span><span class="p">(</span><span class="s1">&#39;ids&#39;</span><span class="p">,</span><span class="n">id_dict</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">id_list</span><span class="p">),</span><span class="s1">&#39;个id保存成功&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>更新成功 364
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">crawl_monthhonor_recipe_ids</span><span class="p">():</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="n">get_monthhonor_urls</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_crawl_recipe_ids</span><span class="p">,</span><span class="n">urls</span><span class="p">)</span>
    <span class="n">rdb</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">decode_responses</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="c1"># host是redis主机，需要redis服务端和客户端都启动 redis默认端口是6379</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">rdb</span><span class="o">.</span><span class="n">hlen</span><span class="p">(</span><span class="s1">&#39;ids&#39;</span><span class="p">)</span>    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;现存id数：&#39;</span><span class="p">,</span><span class="n">counts</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#25235;&#21462;&#33756;&#35889;&#35814;&#24773;&#39029;&#20449;&#24687;">&#25235;&#21462;&#33756;&#35889;&#35814;&#24773;&#39029;&#20449;&#24687;<a class="anchor-link" href="#&#25235;&#21462;&#33756;&#35889;&#35814;&#24773;&#39029;&#20449;&#24687;"> </a></h3><blockquote><p>菜谱名
创建者
创建时间
用料
受欢迎度
评分
html</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_crawl_recipe_content</span><span class="p">(</span><span class="n">_id</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">px</span><span class="p">,</span><span class="n">rdb</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.xiachufang.com/recipe/&#39;</span><span class="o">+</span><span class="n">_id</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">rdb</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s1">&#39;html&#39;</span><span class="p">,</span><span class="n">_id</span><span class="p">,</span><span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> 
        <span class="nb">print</span><span class="p">(</span><span class="n">_id</span><span class="p">,</span><span class="s1">&#39;进度：&#39;</span><span class="p">,</span><span class="nb">format</span><span class="p">(</span><span class="n">rdb</span><span class="o">.</span><span class="n">hlen</span><span class="p">(</span><span class="s1">&#39;html&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">rdb</span><span class="o">.</span><span class="n">hlen</span><span class="p">(</span><span class="s1">&#39;ids&#39;</span><span class="p">),</span><span class="s1">&#39;.2%&#39;</span><span class="p">))</span>
    
<span class="k">def</span> <span class="nf">crawl_monthhonor_recipe_content</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">rdb</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="n">rdb</span><span class="o">.</span><span class="n">hkeys</span><span class="p">(</span><span class="s1">&#39;ids&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_crawl_recipe_content</span><span class="p">,</span><span class="n">ids</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>redis无法存储多层级数据：{'ings': ['面粉（中筋或高筋）', '凉水或热水', '食用油']}</li>
<li>无法存储对象：soup</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_recipe_data" class="doc_header"><code>parse_recipe_data</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/db.py#L19" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_recipe_data</code>(<strong><code>html</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_recipe_data" class="doc_header"><code>get_recipe_data</code><a href="https://github.com/neo4dev/crawler_from_scratch/tree/master/crawler_from_scratch/db.py#L43" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_recipe_data</code>(<strong><code>_id</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#20998;&#26512;&#25968;&#25454;">&#20998;&#26512;&#25968;&#25454;<a class="anchor-link" href="#&#20998;&#26512;&#25968;&#25454;"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>结论是可乐鸡翅的出镜率比较高，小白素食记录的菜谱获奖次数最多</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>暂时还不会用pandas分析用料数据，因为每个元素都是列表，所以先用原始一点的方法，将ings数据单独抽取出来</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>根据热门菜谱分析出了，最常用的20种用料，之后可以统计不同类别的菜系最常见的用料</p>

</div>
</div>
</div>
    {% endraw %}
</div>
 

